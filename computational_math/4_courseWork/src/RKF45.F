      SUBROUTINE RKF45(F,NEQN,Y,T,TOUT,RELERR,ABSERR,
     *                 IFLAG,WORK,IWORK)
C
C     METO PHE-KTTA EEPA ETBEPTOO-TOO OPKA
C
C     COCTABTE POPAMM-H.A.WATTS,L.F.SHAMPINE
C                SANDIA LABORATORIES
C              ALBUQUERQUE, NEW MEXICO
C
C     RKF45 PEHAHAEHA ABHM OPAOM  PEEH
C     HEECTKX  CAO ECTKX EPEHAHX PABHEH,
C     KOA BCEHE POBOHX HE CKOM OPOOCTOEE.
C     RKF45, BOOE OBOP,HE CEET COOBAT
C     EC OOBATE TPEETC BCOKA TOHOCT
C
C     PEME
C
C     OPOPAMMA RKF45 HTEPPET CCTEM  NEQN
C     OKHOBEHHX EPEHAHX PABHEH EPBOO
C     OPKA CEEO BA:
C
C            DY(I)/DT=F(T,Y(1),Y(2),...,Y(NEQN),
C
C     E Y(I) AAH B T.
C     OHO OPOPAMM PMEHT  HTEPPOBAH
C     OT T O TOUT, OHAKO EE MOHO COOBAT  KAK
C     OHOAOB HTEPATOP,TO POOT PEEHE HA
C     OH A B HAPABEH TOUT.HA BXOE APAMETPAM,
C     PPM B CCKE BOBA, PCBABATC HAEH,
C     HEOXOME  POOEH HTEPPOBAH. OO-
C     BATE HHO  EE PA OPATTC K RKF45
C     (,BOMOHO,OPEET HOBOE HAEHE  TOUT).
C     B ECTBTEHOCT RKF45-TO POPAMMA HTEPECA,
C     KOTOPA BBAET OPOPAMM RKFS, OCECTB
C     POECC PEEH.RKFS B CBO OEPE BBAET OPO-
C     PAMM FEHL, KOTOPA BCET PEHHOE PEEHE
C     HA OH A.
C
C     RKF45 COET METO PHE-KTTA-EEPA, OCAHH
C     B CEE KA:E.FEHLBERG,LOW-ORDER CLASSICAL
C     RUNGE-KUTTA FORMULAS WITH STEPSIZE CONTROL,NASA TR R-315
C
C     CT PAOT POPAMM RKF45 CTPPETC B CEX
C     KAX:L.F.SHAMPINE,H.A.WATTS,S.DAVENPORT, SOLVING
C     NON-STIFF ORDINARY DIFFERENTIAL EQUATIONS-THE STAT OF
C     THE ART,SANDIA LABORATORIES REPORT SAND75-0182,SIAM
C     REVIEW,18(1976), N3,376-411.
C
C     APAMETP POPAMM:
C
C     F       -OPOPAMMA F(T,Y,YP)  BCEH
C              POBOHX YP(I)=DY(I)/DT
C     NEQN    -CO HTEPPEMX PABHEH
C     Y(*)    -PEEHE B TOKE T
C     T       -HEABCMA EPEMEHHA
C     TOUT    -TOKA BXOA,B KOTOPO HHO OPEET
C              HAEHE PEEH
C     RELERR  -PAHA OTHOCTEHO OPEHOCT
C               TECTA OKAHO OK.
C     ABSERR  -PAHA ABCOTHO OPEHOCT
C               TECTA OKAHO OK.
C              HA KAOM AE POPAMMA TPEET BOHEH COB
C              ABS(LOCAL ERROR).LE.RELERR*ABS(Y)+ABSERR
C               KAO KOMOHEHT BEKTOPOB OKAHO
C              OK  PEEH
C     IFLAG   -KAATE PEMA HTEPPOBAH.
C     WORK(*) -MACCB,COEPA HOPMA,BHTPEHH  RKF45,
C              KOTOPA HEOXOMA P OCEX BOBAX.EO
C              PAMEPHOCT OHA T HE MEHE 3+6*NEQN
C     IWORK(*)-E MACCB,COEPA HOPMA,BHTPEHH 
C              RKF45,KOTOPA HEOXOMA P OCEX BOBAX.
C              EO PAMEPHOCT OHA T HE MEHE 5.
C
C     EPBOE OPAEHE K RKF45
C
C     OOBATE OEH PECMOTPET B CBOE BBAE
C     POPAMME AMT  CEX MACCBOB, PPX
C     B CCKE BOBA- Y(NEQN), WORK(3+6*NEQN), IWORK(5);
C     KPOME TOO, OH OEH O'BT F B OEPATOPE EXTERNAL,
C     OOTOBT OPOPAMM F(T,Y,YP)  PCBOT HAA-
C     HE HAEH APAMETPAM-
C
C     NEQN  -CO HTEPPEMX PABHEH (NEQN.GE.1)
C     Y(*)  -BEKTOP HAAHX COB
C     T     -HAAHA TOKA HTEPPOBAH,
C            T OHO T EPEMEHHO.
C     TOUT  -TOKA BXOA,B KOTOPO HHO HAT HAEHE
C            PEEH. T=TOUT BOMOHO  P EPBOM
C            OPAEH.B TOM CAE BXO  RKF45 PO-
C            CXOT CO HAEHEM APAMETPA IFLAG=2,EC
C            MOHO POOAT HTEPPOBAHE.
C     RELERR-PAHA  OTHOCTEHO OKAH OPEHOCTE.
C     ABSERR-PAHA  ACOTHO    OKAH OPEHOCTE.
C            T PAH OH T HEOTPATEH.
C            RELERR OHA T EPEMEHHO,A ABSERR MOET
C            T  KOHCTAHTO.POPAMME, BOOE OBOP
C            HE CEET AABAT PAH  OTHOCTEHO
C            OK,MEH, EM PMEPHO 1.E-7. A EAT
C            TPHOCTE ,CBAHHX C OEH BCOKM APOCAM
C            K TOHOCT, POPAMMA TPEET,TO RELERR
C            A OE, EM HEKOTOP APAMETP OTHOCTEHO
C            OK,BCEM BHTP EE  ABC OT
C            MAH.B ACTHOCT,HE PAPEAETC AAHE TOKO
C            ACOTHO OK.EC E AAHO HAEHE RELERR,
C            MEHEE OCTMOO, TO RKF45 BEBAET RELERR
C            HAEAM OPAOM  BOBPAAET PABEHE O-
C            OBATE, PEE EM POOAT HTEPPOBAHE.
C     IFLAG-+1,-1.TO KAATE HACTPOK POPAMM  KAO
C            HOBO AA. HOPMAHOE BXOHOE HAEHE PABHO+1.
C            OOBATE OEH AABAT IFLAG=-1  B TOM
C            CAE,  KOA HEOXOMO PABEHE OHOAOBM
C            HTEPATOPOM.B TOM CAE RKF45 TAETC POOT
C            PEEHE HA OH A B HAPABEH TOUT P KAOM
C            OEPEHOM BOBE. OCKOK TOT PEM PAOT
C            BECMA HEKOHOMEH, EO CEET PMEHT
C             B CAE KPAHE HEOXOMOCT.
C
C     HOPMA HA BXOE
C
C     Y(*)    -PEEHE B TOKE T
C     T       -OCEH TOKA,OCTHTA P HTEPPOBAH.
C     IFLAG=2 -PHTEPPOBAH OCTHTO TOUT.TO HAEHE
C              APAMETPA KABAET HA CEH BXO 
C              BETC HOPMAHM PEMOM  POOEH
C              HTEPPOBAH.
C          =3 -HTEPPOBAHE HE O AKOHEHO -A TOO,
C              TO AAHHOE HAEHE PAH  OTHOCTEHO
C              OK OKAAOC CKOM MAO.  POOEH
C              HTEPPOBAH RELERR O HAEAM OPAOM
C              BEEHO.
C          =4 -HTEPPOBAHE HE O AKOHEHO -A TOO,
C              TO OTPEOBAOC OEE 3000 BCEH PO-
C              BOHO.TO COOTBETCTBYET PTEHO
C              500 AAM.
C          =5 -HTEPPOBAHE HE O AKOHEHO -A TOO,
C              TO PEEHE OPATOC B HY,BCECTBE EO
C              TECT TOKO OTHOCTEHO OK HE POXOT.
C               POOEH HEOXOMO HEHYEBOE HAEHE
C              APAMETPA ABSERR. COOBAHE HA OH A
C              PEMA OAOBOO HTEPPOBAH BETC
C              PAYMHM BXOOM  OOEH.
C          =6 -HTEPPOBAHE  HE O AKOHEHO -A TOO,
C              TO TPEYEMA TOHOCT HE MOA T OCTHTA
C              AE P HAMEHE OCT MO BEHE AA.
C              OOBATE OEH BET PAH OPE-
C              HOCT,PEE EM MOHO ET OTATC
C              POOAT HTEPPOBAHE.
C          =7 -O BCE BMOCT, RKF45 HEEKTBHA P
C              PEEH TO AA. CKOM OOE CO
C              TPEEMX BXOHX TOEK PETCTBET BOP
C              ECTECTBEHHO BEH AA.CEET COOBAT
C              PEM OAOBOO HTEPPOBAH.
C          =8 -HEPABHOE AAHE BXOHX APAMETPOB.TO
C              HAEHE OBETC,EC OEHA OHA 
C              CEX OOK-
C                              NEQN.LE.0
C                  T=TOUT    IFLAG.NE.+1   -1
C                  RELERR    ABSERR.LT.0
C                  IFLAG.EQ.0   .LT.-2   .GT.8
C     WORK(*) -HOPMA, KOTOPA OHO HE PECTABET HTE-
C              PECA  OOBATE, HO HEOXOMA P OCE-
C              X BOBAX. WORK(1),...,WORK(NEQN) COEPAT
C              EPBE POBOHE BEKTOPA PEEH Y B TOKE T.
C              WORK(NEQN+1) XPAHT BEH AA H,C KOTOPO
C              MOHO OTATC POBECT CE A.
C     IWORK(*) -HOPMA, KOTOPA OHO HE PECTABET HTE-
C               PECA  OOBATE, HO HEOXOMA P OCE-
C               X BOBAX. B IWORK(1) COEPTC
C               CETK CA BCEH POBOHX.
C
C     OCEE OPAEH K RKF45
C
C          HA BXOE OPOPAMM RKF45 MEETC BC HOPMA,
C     HEOXOMA   POOEH HTEPPOBAH.EC P
C     HTEPPOBAH OCTHTO TOUT,TO OOBATE OCTA-
C     TOHO OPEET HOBOE HAEHE  TOUT  CHOBA OPATT-
C     C K RKF45.
C          B PEME OAOBOO HTEPPOBAH (IFLAG=-2)
C     OOBATE OEH MET B B,TO KA A
C     BOHETC B HAPABEH TEKEO HAEH TOUT
C     (CHAPEMOM  MEHEHEM IFLAG HA 2). OOBATE
C     OEH AAT HOBOE HAEHE TOUT  EPEOPEET
C     IFLAG HA -2, TO POOAT B PEME OAOBOO
C     HTEPPOBAH.
C          EC HTEPPOBAHE HE O AKOHEHO,HO
C     OOBATE XOET POOAT (CA IFLAG=3,4), OH
C     OPOCT CHOBA OPAAETC K RKF45.P IFLAG=3 APA-
C     METP RELERR   MEHEH HAEAM  POOEH
C     HTEPPOBAH OPAOM.B CAE IFLAG=4 CETK
C     CA HAEH HK ET EPEOPEEEH HA 0, 
C     T PAPEEH EE 3000 BCEH HK.
C          OHAKO B CAE IFLAG=5, PEE EM MOHO ET
C     POOAT HTEPPOBAHE,OOBATE OEH CHAAA
C     MEHT KPTEP OK, AAB OOTEHOE HAEHE
C      ABSERR. EC OH HE CEAET TOO, BOHEHE PO-
C     PAMM ET PEKPAEHO.
C        TOHO TAK E,B CAE IFLAG=6,PEE EM POO-
C     AT HTEPPOBAHE,OOBATE HEOXOMO EPEOPE-
C     ET IFLAG HA 2 ( -2, EC COETC PEM
C     OAOBOO HTEPPOBAH)  BET HAEHE 
C     ABSERR O RELERR,O   TOO,  POO.
C     EC TO HE ET CEAHO,BOHEHE POPAMM
C     PEKPAAETC. OBEHE IFLAG=6 KABAET HA HEPE-
C     PHOCT (PEEHE CTPO MEHETC , BOMOHO,
C     MEETC OCOEHHOCT), ACTO B OOHX CAX
C     HE MEET CMCA POOAT HTEPPOBAHE.
C          EC ET OEHO HAEHE IFLAG=7,TO OO-
C     BATE OEH EPET K PEM OAOBOO HTEPPO-
C     BAH C BEHO AA,OPEEEMO POPAMMO, 
C     PACCMOTPET BOMOHOCTT EPEXOA HA POPAMM METOOB
C     AAMCA.EC BCE E OOBATE XOET POOAT
C     HTEPPOBAHE O OPOPAMME RKF45,OH OEH O HOBOO
C     OPAEH K HE EPEOPEET IFLAG HA 2.B POTBHOM
C     CAE BOHEHE POPAMM ET PEKPAEHO.
C          EC OEHO HAEHE IFLAG=8,TO HTEPPOBAHE
C     HE POOAT,OKA HE T CPABEH OOHE
C     BXOHE APAMETP. HHO OTMETT,TO MACCB WORK 
C     IWORK COEPAT HOPMA,HEOXOM  AHEEO
C     HTEPPOBAH.OTOM B T MACCB HE BHOCT
C     MEHEH.
C
      EXTERNAL F
      INTEGER NEQN,IFLAG,IWORK(5)
      REAL Y(NEQN),T,TOUT,RELERR,ABSERR,WORK(1)
C
C     EC TPAHCTOP POBEPET HEKC, TO AMEHT
C     WORK(1) HA WORK(3+6*NEQN)
C
      INTEGER K1,K2,K3,K4,K5,K6,K1M
C
C     BCT HEKC  PACEEH PAOEO MACCBA
C
      K1M=NEQN+1
      K1=K1M+1
      K2=K1+NEQN
      K3=K2+NEQN
      K4=K3+NEQN
      K5=K4+NEQN
      K6=K5+NEQN
C
C     TA POMEYTOHA POPAMMA POCTO COKPAAET 
C     OOBATE HH CCOK BOBA YTEM PACEEH
C     BYX PAOX MACCBOB. EC TO HE COBMECTMO C
C     TPAHCTOPOM,TO OH OEH OPAATC HEOCPECTBEHHO
C     K OPOPAMME RKFS .
C
      CALL RKFS(F,NEQN,Y,T,TOUT,RELERR,ABSERR,IFLAG,
     *          WORK(1),WORK(K1M),WORK(K1),WORK(K2),
     *          WORK(K3),WORK(K4),WORK(K5),WORK(K6),
     *          WORK(K6+1),IWORK(1),IWORK(2),
     *          IWORK(3),IWORK(4),IWORK(5))
      RETURN
      END
